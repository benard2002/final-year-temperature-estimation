<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IoT Motor Control Dashboard</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="dashboard">
        <nav class="sidebar" id="sidebar">
            <div class="logo">
                <div class="logo-icon">‚ö°</div>
                <span>IoT Control</span>
            </div>

            <div class="nav-section">
                <div class="nav-title">Main</div>
                <div class="nav-item active" data-tab="dashboard">
                    <span class="nav-icon">üìä</span>
                    <span>Dashboard</span>
                </div>
                <div class="nav-item" data-tab="motor">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span>Motor Control</span>
                </div>
                <div class="nav-item" data-tab="history">
                    <span class="nav-icon">üìà</span>
                    <span>History</span>
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-title">AI & Analytics</div>
                <div class="nav-item" data-tab="ai">
                    <span class="nav-icon">ü§ñ</span>
                    <span>AI Inference</span>
                </div>
            </div>

            <div class="nav-section">
                <div class="nav-title">System</div>
                <div class="nav-item" data-tab="settings">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span>Settings</span>
                </div>
            </div>
        </nav>

        <main class="main-content">
            <div class="header">
                <div class="header-left">
                    <button class="menu-toggle" id="menuToggle">
                        <span>‚ò∞</span>
                    </button>
                    <h1 class="page-title" id="pageTitle">Dashboard</h1>
                </div>
                <div class="header-right">
                    <div class="connection-status">
                        <div class="status-dot" id="statusDot"></div>
                        <span id="connectionText">Connected</span>
                    </div>
                    <button class="theme-toggle" id="themeToggle">üåô</button>
                </div>
            </div>

            <div class="content-section active" id="dashboard-content">
                <div class="sensor-grid" id="sensorGrid">
                    <!-- Sensor cards will be generated here -->
                </div>
            </div>

            <div class="content-section" id="motor-content">
                <div class="motor-control">
                    <div class="motor-header">
                        <h2 class="motor-title">Motor Control</h2>
                        <div class="motor-toggle" id="motorToggle"></div>
                    </div>
                    
                    <div class="speed-control">
                        <div class="speed-label">
                            <span>Speed Control</span>
                            <span id="speedValue">0% (OFF)</span>
                        </div>
                        <div class="speed-bar">
                            <div class="speed-fill" id="speedFill"></div>
                        </div>
                        <div class="speed-buttons">
                            <button class="speed-btn active" data-speed="0">OFF</button>
                            <button class="speed-btn" data-speed="1">20%</button>
                            <button class="speed-btn" data-speed="2">40%</button>
                            <button class="speed-btn" data-speed="3">60%</button>
                            <button class="speed-btn" data-speed="4">80%</button>
                            <button class="speed-btn" data-speed="5">100%</button>
                        </div>
                    </div>

                    <div class="emergency-section">
                        <div class="emergency-status" id="emergencyStatus">
                            <span class="status-text">System Status: NORMAL</span>
                            <span class="temp-reading" id="currentTemp">Temp: --¬∞C</span>
                        </div>
                        
                        <button class="emergency-btn" id="emergencyBtn" disabled>
                            <div class="emergency-icon">üõë</div>
                            <span>EMERGENCY STOP</span>
                            <div class="emergency-subtitle">Motor Protection System</div>
                        </button>
                    </div>
                </div>
            </div>

            <div class="content-section" id="history-content">
                <div class="history-section">
                    <h2>Historical Data</h2>
                    <div class="history-controls">
                        <div class="control-group">
                            <label class="control-label">Parameter</label>
                            <select class="control-select" id="historyParameter">
                                <option value="motorVolt">Motor Voltage</option>
                                <option value="motorCurr">Motor Current</option>
                                <option value="motorPower">Motor Power</option>
                                <option value="rotorSpeed">Rotor Speed</option>
                                <option value="efficiency">Efficiency</option>
                                <option value="torque">Torque</option>
                                <option value="energy">Energy</option>
                                <option value="extTemp">External Temp</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label class="control-label">Time Range</label>
                            <select class="control-select" id="historyRange">
                                <option value="1h">Last Hour</option>
                                <option value="6h">Last 6 Hours</option>
                                <option value="24h">Last 24 Hours</option>
                                <option value="7d">Last 7 Days</option>
                            </select>
                        </div>
                        <button class="load-history-btn" id="loadHistory">Load Data</button>
                    </div>
                    <div class="chart-wrapper">
                        <canvas id="historyChart"></canvas>
                    </div>
                </div>
            </div>

            <div class="content-section" id="ai-content">
                <div class="ai-section">
                    <div class="ai-card rotor-temp">
                        <h3>Rotor Temperature Prediction</h3>
                        <div class="temp-circle">
                            <svg>
                                <circle class="temp-bg" cx="75" cy="75" r="60"></circle>
                                <circle class="temp-progress" cx="75" cy="75" r="60" id="tempProgress"></circle>
                            </svg>
                            <div class="temp-value" id="tempValue">45¬∞C</div>
                        </div>
                        <p>AI Predicted Temperature</p>
                    </div>
                    
                    <div class="ai-card">
                        <h3>AI Performance</h3>
                        <div class="ai-stats">
                            <div class="ai-stat">
                                <div class="ai-stat-value" id="aiAccuracy">94.2%</div>
                                <div class="ai-stat-label">Accuracy</div>
                            </div>
                            <div class="ai-stat">
                                <div class="ai-stat-value" id="aiConfidence">87.5%</div>
                                <div class="ai-stat-label">Confidence</div>
                            </div>
                            <div class="ai-stat">
                                <div class="ai-stat-value" id="aiLatency">45ms</div>
                                <div class="ai-stat-label">Latency</div>
                            </div>
                            <div class="ai-stat">
                                <div class="ai-stat-value" id="aiPredictions">1,247</div>
                                <div class="ai-stat-label">Predictions</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="ai-card">
                    <h3>AI Definitions & Insights</h3>
                    <div style="display: grid; gap: 1rem;">
                        <div>
                            <strong>Rotor Temperature Prediction:</strong> Our AI model analyzes motor current, voltage, power, and ambient conditions to predict rotor temperature 5 minutes ahead, helping prevent overheating.
                        </div>
                        <div>
                            <strong>Predictive Maintenance:</strong> Machine learning algorithms detect anomalies in vibration patterns and efficiency drops to predict when maintenance is needed.
                        </div>
                        <div>
                            <strong>Energy Optimization:</strong> AI continuously optimizes motor speed and load factor to minimize energy consumption while maintaining performance.
                        </div>
                        <div>
                            <strong>Fault Detection:</strong> Real-time analysis of electrical parameters helps identify potential faults like bearing wear, insulation degradation, or rotor imbalance.
                        </div>
                    </div>
                </div>
            </div>

            <div class="content-section" id="settings-content">
                <div class="settings-grid">
                    <div class="settings-status" id="settingsStatus"></div>
                    
                    <!-- Email Alert Settings -->
                    <div class="settings-section">
                        <h3>üìß Email Alert Settings</h3>
                        
                        <div class="settings-row">
                            <div class="settings-label">Enable Email Alerts</div>
                            <div class="settings-description">Receive email notifications when temperature thresholds are exceeded or emergencies occur</div>
                            <div class="settings-toggle">
                                <div class="toggle-switch" id="emailAlertsToggle"></div>
                                <span id="emailAlertsStatus">Disabled</span>
                            </div>
                        </div>

                        <div class="settings-row">
                            <div class="settings-label">Alert Recipients</div>
                            <div class="settings-description">Manage email addresses that will receive alert notifications</div>
                            <div class="email-list" id="emailList">
                                <div style="text-align: center; color: var(--text-secondary); font-size: 0.875rem;">No email addresses configured</div>
                            </div>
                            <div class="add-email-section">
                                <input type="email" class="settings-input" id="newEmailInput" placeholder="Enter email address" style="flex: 1;">
                                <button class="add-email-btn" id="addEmailBtn">Add Email</button>
                            </div>
                        </div>
                    </div>

                    <!-- Temperature Threshold Settings -->
                    <div class="settings-section">
                        <h3>üå°Ô∏è Temperature Monitoring</h3>
                        
                        <div class="settings-row">
                            <div class="settings-label">Warning Temperature Threshold</div>
                            <div class="settings-description">Temperature at which warning alerts are triggered (¬∞C)</div>
                            <input type="number" class="settings-input" id="warningTempInput" min="20" max="80" step="1" value="45">
                        </div>

                        <div class="settings-row">
                            <div class="settings-label">Critical Temperature Threshold</div>
                            <div class="settings-description">Temperature at which emergency stops are activated (¬∞C)</div>
                            <input type="number" class="settings-input" id="criticalTempInput" min="30" max="100" step="1" value="50">
                        </div>

                        <div class="settings-row">
                            <div class="settings-label">Temperature Check Interval</div>
                            <div class="settings-description">How often to check temperature readings (seconds)</div>
                            <select class="settings-input" id="tempIntervalSelect">
                                <option value="1">1 second</option>
                                <option value="2" selected>2 seconds</option>
                                <option value="5">5 seconds</option>
                                <option value="10">10 seconds</option>
                            </select>
                        </div>
                    </div>

                    <!-- Motor Protection Settings -->
                    <div class="settings-section">
                        <h3>üõ°Ô∏è Motor Protection</h3>
                        
                        <div class="settings-row">
                            <div class="settings-label">Auto Emergency Stop</div>
                            <div class="settings-description">Automatically stop motor when critical temperature is reached</div>
                            <div class="settings-toggle">
                                <div class="toggle-switch on" id="autoStopToggle"></div>
                                <span id="autoStopStatus">Enabled</span>
                            </div>
                        </div>

                        <div class="settings-row">
                            <div class="settings-label">Auto Stop Delay</div>
                            <div class="settings-description">Seconds to wait before auto-stopping motor at critical temperature</div>
                            <select class="settings-input" id="autoStopDelaySelect">
                                <option value="0">Immediate</option>
                                <option value="3" selected>3 seconds</option>
                                <option value="5">5 seconds</option>
                                <option value="10">10 seconds</option>
                            </select>
                        </div>

                        <div class="settings-row">
                            <div class="settings-label">Motor Cool-down Period</div>
                            <div class="settings-description">Minutes motor must cool before restart after emergency stop</div>
                            <input type="number" class="settings-input" id="cooldownPeriodInput" min="1" max="60" step="1" value="5">
                        </div>
                    </div>

                    <!-- Data Collection Settings -->
                    <div class="settings-section">
                        <h3>üìä Data Collection</h3>
                        
                        <div class="settings-row">
                            <div class="settings-label">Data Collection Interval</div>
                            <div class="settings-description">How often to collect and store sensor data</div>
                            <select class="settings-input" id="dataIntervalSelect">
                                <option value="1">1 second</option>
                                <option value="2" selected>2 seconds</option>
                                <option value="5">5 seconds</option>
                                <option value="10">10 seconds</option>
                                <option value="30">30 seconds</option>
                            </select>
                        </div>

                        <div class="settings-row">
                            <div class="settings-label">Data Retention Period</div>
                            <div class="settings-description">How long to keep historical data</div>
                            <select class="settings-input" id="retentionSelect">
                                <option value="7">7 days</option>
                                <option value="30" selected>30 days</option>
                                <option value="90">90 days</option>
                                <option value="365">1 year</option>
                            </select>
                        </div>
                    </div>

                    <!-- Save Button -->
                    <button class="save-settings-btn" id="saveSettingsBtn">üíæ Save All Settings</button>
                </div>
            </div>
        </main>
    </div>

    <div class="chart-modal" id="chartModal">
        <div class="chart-container" id="chartContainer">
            <div class="chart-header">
                <h3 class="chart-title" id="modalTitle">Sensor Chart</h3>
                <button class="close-btn" id="closeModal">‚úï</button>
            </div>
            <div class="chart-wrapper">
                <canvas id="sensorChart"></canvas>
            </div>
            <div class="chart-stats" id="chartStats">
                <!-- Chart statistics will be displayed here -->
            </div>
        </div>
    </div>

    <script src="js/main.js"></script>
</body>
</html>